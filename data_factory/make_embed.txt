import torch
import numpy as np
import pandas as pd
import os



data_dir = "data_factory/data"

file_address = os.path.join(data_dir, "delaney.csv")
df = pd.read_csv(file_address)

char_set = set()
for i in range(len(df)):
  for c in df.iloc[i]["SMILES"].strip():
    char_set.add(c)

char_list = sorted(list(char_set))
compress_df = pd.DataFrame({"embed": range(len(char_list)), "char": char_list})
compress_df.to_csv(os.path.join(data_dir, "embed.csv"), index_label=False)